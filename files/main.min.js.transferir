var ajaxRequest=function(a,b,c){jQuery.isPlainObject(a)||a.match(/=/i)||(a=$(a).serialize()),$.ajax({type:"POST",url:site.ajax,data:a,timeout:6e4}).done(function(a){a.error?null!=c&&c(a):null!=b&&b(a)}).fail(function(a){null!=c&&c(a)})},nl2br=function(a){return(a+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br>$2").replaceAll(" ","&nbsp;")};$("ul.dropdown-menu [data-toggle='dropdown']").on("click",function(a){a.preventDefault(),a.stopPropagation(),$(this).siblings().toggleClass("show"),$(this).next().hasClass("show")||$(this).parents(".dropdown-menu").first().find(".show").removeClass("show"),$(this).parents("li.nav-item.dropdown.show").on("hidden.bs.dropdown",function(){$(".dropdown-submenu .show").removeClass("show")})}),$("#toggleDarkMode").click(function(){$("#lightMode, #darkMode").addClass("d-none"),"undefined"==typeof Cookies.get("toogleThemeMode")||"light"==Cookies.get("toogleThemeMode")?(Cookies.set("toogleThemeMode","dark",{expires:365,path:"/"}),$("#darkMode").removeClass("d-none"),$("body").addClass("dark")):(Cookies.set("toogleThemeMode","light",{expires:365,path:"/"}),$("#lightMode").removeClass("d-none"),$("body").removeClass("dark"))}),$(".popover-item").popover({}),$("[data-toggle=\"offcanvas\"]").on("click",function(){$(".navbar-collapse").toggleClass("show")});var copyToClipboard=function(a){var b=$("<textarea>");$("body").append(b),b.val(a.replace(/<br\s*[\/]?>/gi,"\r\n")).select(),document.execCommand("copy"),b.remove()};$(".show-packet-detail").click(function(){$(".packet-details, .btn-packet-details").remove();var a=$(this).closest("tr"),b=a.find("td:nth-child(2) a").text().trim(),c=a.find("td:nth-child(4) a").text().trim(),d=$("input[name=\"versionId\"]").val();ajaxRequest({type:"GetPacketDetail",versionId:d,requestPackageId:b,responsePackageId:c},function(b){var c="<tr class=\"btn-packet-details\">";c+="<td colspan=\"2\"><button class=\"btn btn-sm w-100 btn-success copy-network-schema-first\">T\xFCm\xFCn\xFC Kopyala</button></td>",c+="<td colspan=\"2\"><button class=\"btn btn-sm w-100 btn-success copy-network-schema-last\">T\xFCm\xFCn\xFC Kopyala</button></td>",c+="</tr>",c+="<tr class=\"packet-details\">",c+="<td colspan=\"2\"><code>"+nl2br(b.Request.replaceAll("<","&lt;").replaceAll(">","&gt;"))+"</code></td>",c+="<td colspan=\"2\"><code>"+nl2br(b.Response.replaceAll("<","&lt;").replaceAll(">","&gt;"))+"</code></td>",c+="</tr>",a.after(c)},function(a){alert(a.msg)})}),$("body").on("click",".copy-network-schema-first",function(){copyToClipboard($(".packet-details td:first code").html().replaceAll("&nbsp;"," ").replaceAll("<br>","").replaceAll("&lt;","<").replaceAll("&gt;",">"))}),$("body").on("click",".copy-network-schema-last",function(){copyToClipboard($(".packet-details td:last code").html().replaceAll("&nbsp;"," ").replaceAll("<br>","").replaceAll("&lt;","<").replaceAll("&gt;",">"))});var showClanDetails=function(a,b,c,d){a.find(".loadingRow").removeClass("d-none"),a.find("tbody tr:not(.loadingRow)").remove(),d?(a.find(".atk_column").removeClass("d-none"),a.find(".medal_column").addClass("d-none")):(a.find(".atk_column").addClass("d-none"),a.find(".medal_column").removeClass("d-none")),ajaxRequest({type:"GuildVersusBattleMemberRanks",attackerGuildId:b,defenderGuildId:c,onlyAttack:d?1:0},function(b){for(var c="",d=0;60>=d;d++){var e=b.Attacker[d],f=b.Defender[d];if(e==null&&f==null)break;c+="<tr>",c+="<td>"+(d+1)+"</td>",e==null?(c+="<td>-</td>",c+="<td class=\"text-center\">-</td>"):(c+="<td>"+e.NickName+"</td>",c+=null==e.Attack?"<td class=\"text-center\">"+(0<e.Score?e.Score:"-")+"</td>":"<td class=\"text-center\">"+e.Attack+"</td>"),f==null?(c+="<td>-</td>",c+="<td class=\"text-center\">-</td>"):(c+="<td>"+f.NickName+"</td>",c+=null==f.Attack?"<td class=\"text-center\">"+(0<f.Score?f.Score:"-")+"</td>":"<td class=\"text-center\">"+f.Attack+"</td>"),c+="</tr>"}a.find(".loadingRow").addClass("d-none"),a.find("tbody").append(c)})};$(".show-clan-medals").click(function(){showClanDetails($(this).closest(".clan-war-container"),$(this).data("attackerid"),$(this).data("defenderid"),!1)}),$(".show-clan-members").click(function(){showClanDetails($(this).closest(".clan-war-container"),$(this).data("attackerid"),$(this).data("defenderid"),!0)}),$(".clan-war-container").each(function(){var a=$(this).find("button");a&&showClanDetails($(this),a.data("attackerid"),a.data("defenderid"),!0)}),$(".survivor-item-container, .survivor-popover").popover({html:!0,placement:"top",trigger:"hover"}),$("#change-event").change(function(){window.location.href=site.url+"event/details/"+$(this).val()}),$(".show-ender-echo-detail").click(function(){ajaxRequest({type:"GetEnderEchoResult",playerUserId:$(this).closest("tr").find("td:nth-child(2)").text(),showId:$(this).data("showid")},function(a){$("#ender-echo-modal .modal-body").html(a.Data),$("#ender-echo-modal").modal("show")})}),$("#clanPageBasicVersion").change(function(){$("table tr .table-mobile-hide-column").attr("data-p",!0),$(this).is(":checked")?$("table tr [data-p]").addClass("table-mobile-hide-column"):$("table tr [data-p]").removeClass("table-mobile-hide-column")});